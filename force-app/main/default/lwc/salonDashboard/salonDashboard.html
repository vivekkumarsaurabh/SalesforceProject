<template>
    <template if:true={isLoadingDataa}>
        <lightning-spinner alternative-text="Loading" variant="brand" size="large">
        </lightning-spinner>
    </template>

    <template if:true={isDeleteModal}>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-03" aria-modal="true"
            aria-describedby="modal-content-id-3" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <header class="slds-modal__header">
                    <h2 id="modal-heading-03" class="slds-text-heading_medium slds-hyphenate">Delete Appointment</h2>
                </header>
                <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-3">
                    <h1>Are you sure you want to delete this appointment?</h1>
                </div>
                <footer class="slds-modal__footer">
                    <button class="slds-button slds-button_neutral" onclick={deleteCancelModal}
                        title="Cancel">Cancel</button>
                    <button class="slds-button slds-button_brand" onclick={deleteHandler}
                        title="delete file">Delete</button>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>

    <template if:true={isDeleteModalContact}>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-04" aria-modal="true"
            aria-describedby="modal-content-id-4" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <header class="slds-modal__header">
                    <h2 id="modal-heading-04" class="slds-text-heading_medium slds-hyphenate">Delete Contact</h2>
                </header>
                <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-4">
                    <h1>Are you sure you want to delete this contact?</h1>
                </div>
                <footer class="slds-modal__footer">
                    <button class="slds-button slds-button_neutral" onclick={deleteConCancelModal}
                        title="Cancel">Cancel</button>
                    <button class="slds-button slds-button_brand" onclick={deleteContactHandler}
                        title="delete file">Delete</button>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>

    <template if:true={isCreateUserModal}>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-05" aria-modal="true"
            aria-describedby="modal-content-id-3" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <header class="slds-modal__header">
                    <h2 id="modal-heading-05" class="slds-text-heading_medium slds-hyphenate">Create User</h2>
                </header>
                <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-5">

                    <div class="slds-form" style="width: 100%; padding:5%;">
                        <div class="slds-form-element slds-form-element_stacked">
                            <div class="slds-form-element__control">
                                <lightning-input type="text" label="Full Name" name="userName" class="validate"
                                    placeholder="Enter Your Full Name" maxlength="100" required></lightning-input>
                            </div>
                        </div>
                        <div class="slds-form-element slds-form-element_stacked">
                            <div class="slds-form-element__control">
                                <lightning-input type="email" label="Email" name="userEmail" class="validate"
                                    placeholder="Your Email" required
                                    pattern="^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/"
                                    message-when-pattern-mismatch="Please enter a valid phone number like john@gmail.com"></lightning-input>
                            </div>
                        </div>
                        <div class="slds-form-element slds-form-element_stacked">
                            <div class="slds-form-element__control">
                                <lightning-input type="phone" label="Phone" name="userPhone" class="validate"
                                    placeholder="Enter Your Phone" required
                                    pattern="^(\+91[\-\s]?)?[0]?(91)?[789]\d{9}$"
                                    message-when-pattern-mismatch="Please enter a valid phone number"></lightning-input>
                            </div>
                        </div>
                        <div class="slds-form-element slds-form-element_stacked">
                            <div class="slds-form-element__control">
                                <lightning-input type="password" label="Password" name="userPassword" class="validate"
                                    placeholder="Enter Your Password" required
                                    onchange={passwordHandle}></lightning-input>
                            </div>
                        </div>
                        <div class="slds-form-element slds-form-element_stacked">
                            <div class="slds-form-element__control">
                                <template if:true={isCorrectPassword}>
                                    <lightning-icon class="iconHover" icon-name="utility:success"
                                        alternative-text="preview" size="xx-small"
                                        style="--sds-c-icon-color-foreground-default:rgb(21, 138, 48); left:16%; top:20px; position:relative;"></lightning-icon>
                                </template>
                                <template if:true={isMatchPassword}>
                                    <lightning-icon class="iconHover" icon-name="utility:close"
                                        alternative-text="preview" size="xx-small"
                                        style="--sds-c-icon-color-foreground-default:rgb(203, 30, 30); left:16%; top:20px; position:relative;"></lightning-icon>
                                </template>
                                <lightning-input type="password" label="Re_Password" name="userRePassword"
                                    class="validate" placeholder="Enter Your Password again" required
                                    onchange={matchPasswordHandler}></lightning-input>
                            </div>

                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <button class="slds-button slds-button_neutral" onclick={handleCancelCreate}
                            title="Cancel">Cancel</button>
                        <button class="slds-button slds-button_brand" onclick={handleCreateSubmit}>save</button>
                    </footer>
                </div>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>


    <template if:true={isUpdateProfile}>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-06" aria-modal="true"
            aria-describedby="modal-content-id-4" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <header class="slds-modal__header">
                    <h2 id="modal-heading-06" class="slds-text-heading_medium slds-hyphenate">Update Profile</h2>
                </header>
              <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-6">
             <lightning-record-edit-form record-id={userId} object-api-name={objectApiName} onsuccess={handleSuccess} onsubmit ={handleSubmit}>                
            <lightning-input-field field-name="Name" ></lightning-input-field>
            <lightning-input-field field-name="Email__c"></lightning-input-field>
            <lightning-input-field field-name="Phone__c"></lightning-input-field>
            <lightning-input-field type="password" field-name="Password__c"></lightning-input-field>
            </lightning-record-edit-form>
          </div>
                <footer class="slds-modal__footer">                 
                        <lightning-button class="slds-button slds-m-top_small" variant="brand" label="Cancel" onclick={updateCancelHandler}></lightning-button>
                        <lightning-button class="slds-button slds-m-top_small" variant="brand" type="submit" name="update" label="Update" onclick={updateProfileHandler}>
                        </lightning-button>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>



    <div style="margin: auto;">
        <template if:true={isLogIn}>
            <div class="userLogIn" style="margin: auto;">
                <div style="text-align: center; margin-top:5%;">
                  
                <img src={avtarUrl} alt="no Image" class="imgAvtar">
                </div>
                <br>
                <div class="slds-form" style="">
                    <div class="slds-form-element slds-form-element_stacked">
                        <label class="slds-form-element__label" for="stacked-input-id-04">User Email</label>
                        <div class="slds-form-element__control">
                            <input type="text" id="stacked-input-id-04" placeholder="Enter Your Full Name"
                                class="slds-input" onchange={userEmail} />
                        </div>
                    </div>
                    <br>
                    <div class="slds-form-element slds-form-element_stacked">
                        <label class="slds-form-element__label" for="stacked-input-id-05">User Password</label>
                        <div class="slds-form-element__control">
                            <input type="password" id="stacked-input-id-05" placeholder="Enter Your Password"
                                class="slds-input" onchange={userPassword} />
                        </div>
                    </div>
                    <div style="text-align: center; line-height:1%;">
                        <button class="slds-button slds-button_brand" style="padding:4px 50px;margin-top:25px;"
                            onclick={handleLogin}>
                            Login</button>

                        <h4 class="newBtn" onclick={createUserHandler}>New</h4>
                    </div>


                </div>
            </div>
        </template>
        <template if:true={isDashBoard}>
            <div class="slds-grid">
                <div class="slds-col slds-size_2-of-12 sideMenu">
                    <div class="slds-grid" style="margin: auto;">
                        <div class="slds-col slds-size_4-of-12" style="margin: auto;">
                            <img src={logoImg} alt="logo Image" width="50" height="50" style="margin-left:15px;">
                        </div>
                        <div class="slds-col slds-size_8-of-12" style="margin: auto;">
                            <h1 style="font-size: 1.5rem; margin-top:10px; font-weight:500; color:#fff;">Stylish Salon
                            </h1>
                        </div>
                    </div>
                    <br>
                    <ul>
                        <li>
                            <h2 class="menuItem" style="background-color:blueviolet; color:#fff;"
                                onclick={handleHomeDashboard}><lightning-icon class="iconHover" icon-name="utility:home"
                                    alternative-text="preview" size="small"
                                    style="--sds-c-icon-color-foreground-default:#fff;"></lightning-icon>
                                &nbsp; Home</h2>
                        </li>
                        <li>
                            <h2 class="menuItem" style="color:#fff;" onclick={handleAppointment}><lightning-icon
                                    class="iconHover" icon-name="utility:service_appointment" alternative-text="preview"
                                    size="small" style="--sds-c-icon-color-foreground-default:#fff;"></lightning-icon>
                                &nbsp; Appointments</h2>
                        </li>
                        <li>
                            <h2 class="menuItem" style="color:#fff;" onclick={handleContact}><lightning-icon
                                    class="iconHover" icon-name="utility:chat" alternative-text="preview" size="small"
                                    style="--sds-c-icon-color-foreground-default:#fff;"></lightning-icon>
                                &nbsp; Contacts</h2>
                        </li>
                        <li>
                            <h2 class="menuItem" style="color:#fff;" onclick={handleUpdateProfile}><lightning-icon
                                    class="iconHover" icon-name="utility:profile_alt" alternative-text="preview"
                                    size="small" style="--sds-c-icon-color-foreground-default:#fff;"></lightning-icon>
                                &nbsp; Update Profile</h2>
                        </li>
                        <li>
                            <h2 class="menuItem" style="color:#fff;" onclick={handleSignUp}><lightning-icon
                                    class="iconHover" icon-name="utility:logout" alternative-text="preview" size="small"
                                    style="--sds-c-icon-color-foreground-default:#fff;"></lightning-icon>
                                &nbsp; LogOut</h2>
                        </li>
                    </ul>

                </div>
                <div class="slds-col slds-size_10-of-12">
                    <div class="slds-grid" style="background-color:rgb(12 193 203 / 38%);;">
                        <div class="slds-col slds-size_10-of-12">
                            <h1 style="font-size: 1.5rem; color:#000; margin:10px;">Welcome to Stylish Salon</h1>
                        </div>
                        <div class="slds-col slds-size_2-of-12">
                            <div class="slds-grid">
                                <div class="slds-col slds-size_4-of-12">
                                    <img src={avtarUrl} alt="no Image" class="imgProfile">
                                </div>
                                <div class="slds-col slds-size_8-of-12">
                                    <h1 style="margin-top: 15px; font-size: 1.3rem; font-weight: 400;">{UserName}</h1>
                                </div>
                            </div>

                        </div>
                    </div>
                    <template if:true={isHome}>
                        <div style="height:600px; background-color: rgb(246, 246, 246);">
                            <div class="slds-grid" style="">
                                <div class="slds-col slds-size_6-of-12" style=" margin-top:20px;">
                                    <div class="slds-grid" style="justify-content: space-around;">
                                        <div class="slds-col slds-size_5-of-12"
                                            style="background-color: #1326b9; color:#fff; border-radius:20px; padding:20px; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);">
                                            <lightning-icon class="iconHover" icon-name="utility:service_appointment"
                                                alternative-text="preview" size="small"
                                                style="--sds-c-icon-color-foreground-default:#fff; margin-left:5%;"></lightning-icon>

                                            <h1 style="font-size: 1rem; font-weight:300; margin-left:5%;">Total
                                                Appointments</h1>

                                            <h1 style="font-size: 1rem; font-weight:300; margin-left:5%;">
                                                {totalAppointment}</h1>
                                        </div>
                                        <div class="slds-col slds-size_5-of-12"
                                            style="background-color: #f510a4; color:#fff; border-radius:20px; padding:20px; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);">
                                            <lightning-icon class="iconHover" icon-name="utility:adduser"
                                                alternative-text="preview" size="small"
                                                style="--sds-c-icon-color-foreground-default:#fff; margin-left:5%;"></lightning-icon>

                                            <h1 style="font-size: 1rem; font-weight:300; margin-left:5%;">Total Contacts
                                            </h1>

                                            <h1 style="font-size: 1rem; font-weight:300; margin-left:5%;">{totalContact}
                                            </h1>
                                        </div>

                                    </div>
                                    <br>
                                    <div class="slds-grid" style="justify-content: space-around;">
                                        <div class="slds-col slds-size_5-of-12"
                                            style="background-color: #ce8313; color:#fff; border-radius:20px; padding:20px; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);">
                                            <lightning-icon class="iconHover" icon-name="utility:service_appointment"
                                                alternative-text="preview" size="small"
                                                style="--sds-c-icon-color-foreground-default:#fff; margin-left:5%;"></lightning-icon>

                                            <h1 style="font-size: 1rem; font-weight:300; margin-left:5%;">Future
                                                Appointments</h1>

                                            <h1 style="font-size: 1rem; font-weight:300; margin-left:5%;">
                                                {futureAppointment}</h1>
                                        </div>
                                        <div class="slds-col slds-size_5-of-12"
                                            style="background-color: #14c343; color:#fff; border-radius:20px; padding:20px; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);">
                                            <lightning-icon class="iconHover" icon-name="utility:adduser"
                                                alternative-text="preview" size="small"
                                                style="--sds-c-icon-color-foreground-default:#fff; margin-left:5%;"></lightning-icon>

                                            <h1 style="font-size: 1rem; font-weight:300; margin-left:5%;">Past
                                                Appointments
                                            </h1>

                                            <h1 style="font-size: 1rem; font-weight:300; margin-left:5%;">
                                                {countPastAppoitment}</h1>
                                        </div>

                                    </div>
                                </div>
                                <div class="slds-col slds-size_6-of-12"
                                    style="background-color: #fff; margin-top:20px; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2); border-radius:20px;">
                                    <div if:true={isChartJsInitialized} class="slds-col--padded slds-size--1-of-1">
                                        <canvas class="barChart" lwc:dom="manual"></canvas>
                                    </div>
                                    <div if:false={isChartJsInitialized} class="slds-col--padded slds-size--1-of-1">
                                        ChartJs Not loaded yet
                                    </div>
                                </div>
                            </div>
                            <br>
                            <div class="slds-grid" style="">
                                <div class="slds-col slds-size_6-of-12" style="background-color: #fff;  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2); border-radius:10px;">
                                   
                                   <div if:true={isChartJsInitialized} class="slds-col--padded slds-size--1-of-1">
                                        <canvas class="doughnutChart" lwc:dom="manual"></canvas>
                                    </div>
                                    <div if:false={isChartJsInitialized} class="slds-col--padded slds-size--1-of-1">
                                        ChartJs Not loaded yet
                                    </div>
                                </div>
                                <div class="slds-col slds-size_6-of-12" style="background-color: #fff;  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2); border-radius:10px;">
                                    <div if:true={isChartJsInitialized} class="slds-col--padded slds-size--1-of-1">
                                        <canvas class="piechart" lwc:dom="manual"></canvas>
                                    </div>
                                    <div if:false={isChartJsInitialized} class="slds-col--padded slds-size--1-of-1">
                                        ChartJs Not loaded yet
                                    </div>
                                </div>
                            </div>
                        </div>
                    </template>
                    <template if:true={isAppointment}>
                        <div style="height:600px; background-color: rgb(218 219 224);">
                            <div class="slds-grid">
                                <div class="slds-col slds-size_7-of-12"></div>
                                <div class="slds-col slds-size_2-of-12">
                                    <button class="slds-button slds-button_brand" onclick={handleStatus}
                                        style="margin-left:32%; margin-top:10%;" disabled={isBtnDisable}>Status
                                        Completed</button>
                                </div>
                                <div class="slds-col slds-size_3-of-12">
                                    <lightning-input type="date" name="input1" label="Date Filter" class="datePicker"
                                        value={dateToday} style="width:60%; margin-left:25%; display:inline-block;"
                                        onchange={handledateFilter}></lightning-input>
                                </div>
                            </div>
                            <template if:true={isIllustractionTrue}>
                                <div class="noData">
                                    <c-no-data></c-no-data>
                                </div>
                            </template>
                            <template if:true={isRecord}>
                                <lightning-datatable data={records} columns={columns} key-field="Id"
                                    class="dataTableRec" onrowaction={handleRowAction} onrowselection={getSelectedRow}
                                    style="height: 500px;"></lightning-datatable></template>

                        </div>
                    </template>
                    <!-- <template if:true={isAppointment}>
                            <div style="height:600px">
                                <lightning-datatable data={records} columns={columns} key-field="Id"
                                enable-infinite-loading onloadmore={loadMoreData} hide-checkbox-column="true" onrowaction={handleRowAction} style="height: 500px;"></lightning-datatable>
                            </div>
                        </template> -->
                    <template if:true={isContacts}>
                        <div style="height:600px; background-color: rgb(218 219 224);">
                            <lightning-datatable data={recordsContact} columns={columnsContact} key-field="Id"
                                onrowaction={handleRowActionContact} style="height: 500px;"></lightning-datatable>
                        </div>
                    </template>

                </div>
            </div>

        </template>
    </div>

</template>